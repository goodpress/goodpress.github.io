#app性能之首页加载速度探索

####背景

团队想分析下我们自己的 app 与竞品 app 在性能方面的差距.

####收集指标

- 首页加载速度,期望值从点击到首屏展示出来3秒内
- 页面间切换1秒内完成
- 下载下一页1秒内完成(暂定)
- List 页3G 下流量消耗,单个商品不超过10KB(暂定)
- Detail 页3G 下流量消耗,单个商品不超过500KB( 暂定)


####首页加载速度

**初期想到的几个方案**

1. 在首屏的函数中打上 log 方式,会存在下面几个问题:
	
	- 首页函数中有异步加载函数,可能首页 viewdidappear 执行完了,但是UI 上部分区域还在等待服务端返回
	-  代码侵入太强,竞争对手 app无法采用此方法

2. 采用[instrument 帧率测试](http://baike.corp.taobao.com/index.php/20131128#2.iOS):
	-  instrument它本身就影响 app 性能
	- 代码侵入

**比较挫的解决办法**

录制点击视频,然后寻找开始帧,结束帧,计算出时间差.具体方法:

工具:

- mac 安装 [airServer](http://soft.macx.cn/soft4742.htm)
- mac 安装 [Final cup pro x](http://pan.baidu.com/s/1bn2CWTh)

步骤:

1. 手机连接 airserver, 同步画面
2. 录制点开竞品 app 及自己 app
3. 视频传入mac
4. 视频拖入 FinalCutPro
5. 寻找界面自己手指按下然后`抬起那一帧`.然后按 command+b 剪一刀
6. 寻找首页完全`加载完那一帧`,按下 command + b 剪一刀
7. 然后选中中间这一段,会自动显示时间.

**个人观点**:

Wi-Fi 下用户更关心 app 启动速度,3G 下用户更关心耗费的流量.所以启动速度建议 Wi-Fi 下收集,流量3G 下收集.